{% extends "layout.html" %}

{% block title %}
    Intro
{% endblock %}

{% block main %}
<br>
<br>
<table class="table" style:"width:100%">
    <th>
    <td><p class="lead" style="display: inline;font-weight: 400">Main gene</p></td>
    <td><p class="lead" style="display: inline;font-weight: 400">Ortholog gene </p></td>
    </th>
    <tr>
        <td><p class="lead" style="display: inline;font-weight: 400">Ensembl gene id</p></td>
        <td><p class="lead" style="display: inline">{{ source_gene }}</p></td>
        <td><p class="lead" style="display: inline">{{ ortho_gene }}</p></td>
    </tr>
    <tr>
        <td><p class="lead" style="display: inline;font-weight: 400">Taxon</p></td>
        <td><p class="lead" style="display: inline">{{ source_taxon }}</p></td>
        <td><p class="lead" style="display: inline">{{ ortho_taxon }}</p></td>
    </tr>
    <tr>
        <td><p class="lead" style="display: inline;font-weight: 400">Specie</p></td>
        <td><p class="lead" style="font-style: italic; display: inline"> {{ source_specie }}</p></td>
        <td><p class="lead" style="font-style: italic; display: inline"> {{ ortho_specie }}</p></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
    </tr>
</table>

<br>

<h4>Comparison</h4>
<p class = "lead">Sequence similarity: {{ perc_id }}%</p>
<p class = "lead">Cigar string: {{ ortho_cigar }}</p>

<script>
    function open_close(elem){
        var align = document.getElementById(elem);
        console.log(align);
        if (align.style.display === "none") 
        {
            align.style.display = "block";
        } 
        else 
        {
            align.style.display = "none";
        }
    }
</script>
<br>
<button onclick="open_close('align')" class="btn">Open/Close alignment</button>
<br><br>

<div id='align' style="display: none;word-break: break-all;word-wrap: break-word">
<table class="table" style:"width:100%">
{%for line in total_align%}
<tr>
    <td><p style="font-style: italic; display: inline">{{ source_specie }}</p></td>
  <td style="font-family: 'Courier New', Courier, monospace">{{ line[0] }}</td>
</tr>
<tr>
    <td><p style="font-style: italic; display: inline">{{ ortho_specie }}</p></td>
  <td style="font-family: 'Courier New', Courier, monospace">{{ line[1] }}</td>
</tr>
<tr>
    <td></td>
    <td></td>
</tr>
{%endfor%}
</table>
</div>

<hr>
<br>
<h4>Encoded proteins</h4>
<br>

<table class="table" style:"width:50%">
<tr>
    <th colspan="3"><p style="font-style: italic; font-weight: 400" class="lead">{{ source_specie }}</p> ({{ source_gene }})</th>
</tr>
<tr>
    <th><p style="font-weight: 500;display: inline">Gene id</p></th>
    <th><p style="font-weight: 500;display: inline">Protein sequence</p></th>    
    <th><p style="font-weight: 500;display: inline">Pfam results</p></th>     
</tr>
{% for protein in source_proteins %}
    <tr>
        <td width = "20%">{{ protein[0] }}</td>
        <td width="40%">
        <button onclick="open_close('@({{ protein[0] }})')" class="btn">Show/Hide</button>
        <br><br>
        <p id="@({{ protein[0] }})" style="display: none;word-break: break-all;word-wrap: break-word">{{ protein[1] }}</p>       
        </td>
        <td width="40%">
            {% for key, value in source_pfam.items() %}
                {% if key == protein[0] %}
                    <p>Key: {{key}}</p>
                    <p>Value: {{value}}</p>
                {% endif %}
           {% endfor %}
        </td>
        
    </tr>
{% endfor %}
</table>
<hr>
<br><br>
<table class="table" style:"width:50%">
<tr>
    <th colspan="3"><p style="font-style: italic; font-weight: 400" class="lead">{{ ortho_specie }}</p> ({{ ortho_gene }})</th>
</tr>
<tr>
    <th><p style="font-weight: 500;display: inline">Gene id</p></th>
    <th><p style="font-weight: 500;display: inline">Protein sequence</p></th>    
    <th><p style="font-weight: 500;display: inline">Pfam results</p></th>     
</tr>
{% for protein in ortho_proteins %}
    <tr>
        <td width="20%">{{ protein[0] }}</td>
        <td width="40%">
        <button onclick="open_close('@({{ protein[0] }})')" class="btn">Show/Hide</button>
        <br><br>
        <p id="@({{ protein[0] }})" style="display: none;word-break: break-all;word-wrap: break-word">{{ protein[1] }}</p>
        </td>
        <td width="40%">
        
        </td>
    </tr>
{% endfor %}
</table>
<hr>


{% endblock %}
